************************************************************************
* Program Name      : ZACO39R_DEPC
* Author            : Hyung Jin Youn
* Creation Date     : 29/09/2003
* Specifications By : Jin-Won Hong
* Pattern           : Report 1-1
* Development Request No: UD1K902281
* Add documentation :
* Description       : Display Planned Depreciation Cost data in Table
*                     "ZTCO_PLANDEP"
*                     Generated by report tools
* the BDC structures for BATCH INPUT processing
*
* Modifications Log
* Date   Developer   Request ID    Description
*
************************************************************************
* Comments
* This report was generated by SAP and changed by programmer
* The naming convension can be different from that
* in HMMA Development Standard Document (v2)
REPORT ZACO39R_DEPC
   LINE-SIZE 253 NO STANDARD PAGE HEADING LINE-COUNT 000(003).

INCLUDE <SYMBOL>.
INCLUDE <ICON>.
SELECTION-SCREEN: BEGIN OF BLOCK PROG
                           WITH FRAME TITLE TEXT-F58.

TABLES ZTCO_PLANDEP.
DATA %COUNT-ZTCO_PLANDEP(4) TYPE X.
DATA %LINR-ZTCO_PLANDEP(2).

TABLES AQLDB.

INCLUDE RSAQEXCD.

DATA: BEGIN OF %ST_LISTE OCCURS 100,
          HEAD(1),
          TAB(3),
          LINE(6) TYPE N,
          CONT(1) TYPE N,
          FINT(1),
          FINV(1),
          FCOL(1) TYPE N,
          TEXT(0253),
      END OF %ST_LISTE.

DATA %DATA_SELECTED(1).
DATA %GLFRAME(1)  VALUE 'X' .
DATA %UFLAG(1).
DATA %USTFLAG(1).
DATA %GRST_TEXT(255).
DATA %GLLINE TYPE I.
DATA %TABIX LIKE SY-TABIX.
DATA %PRFLAG(1) TYPE X VALUE '02'.


DATA %PERC(4) TYPE P DECIMALS 3.
DATA %P100(4) TYPE P DECIMALS 3 VALUE '100.000'.
DATA %RANGCT TYPE I.
DATA %RANGCC(8).
DATA %SUBRC LIKE SY-SUBRC.

DATA: BEGIN OF %WA010 OCCURS 10,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            BEGIN OF ZTCO_PLANDEP,
                  ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            END OF ZTCO_PLANDEP,
      END OF %WA010.

DATA: BEGIN OF %WA020 OCCURS 10,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            BEGIN OF ZTCO_PLANDEP,
                  ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            END OF ZTCO_PLANDEP,
      END OF %WA020.

DATA: BEGIN OF %WA030 OCCURS 10,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
            BEGIN OF ZTCO_PLANDEP,
                  ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            END OF ZTCO_PLANDEP,
      END OF %WA030.

DATA: BEGIN OF %W0100 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0100.

DATA: BEGIN OF %W0106 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0106.

DATA: BEGIN OF %W0105 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0105.

DATA: BEGIN OF %W0104 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0104.

DATA: BEGIN OF %W0103 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0103.

DATA: BEGIN OF %W0102 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0102.

DATA: BEGIN OF %W0101 OCCURS 20,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
            ZTCO_PLANDEP-VAL07(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL01(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL06(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL05(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL08(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL02(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL03(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL04(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL13(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL12(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL18(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL17(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL16(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL15(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL14(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL09(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL10(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL11(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL19(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL20(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL26(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL25(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL24(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL23(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL22(16) TYPE P DECIMALS 02,
            ZTCO_PLANDEP-VAL21(16) TYPE P DECIMALS 02,
      END OF %W0101.

*//  2011.08.23  insert for ecc6.  by YN.Kim
data: gv_auth_classname   type AQS_CLSNA
* {* Paul 2011/08/24 inser value
      VALUE 'CL_QUERY_TAB_ACCESS_AUTHORITY'.
* *}
*

SELECT-OPTIONS SP$00001 FOR ZTCO_PLANDEP-KOKRS MEMORY ID CAC.
SELECT-OPTIONS SP$00002 FOR ZTCO_PLANDEP-BUKRS MEMORY ID BUK.
SELECT-OPTIONS SP$00003 FOR ZTCO_PLANDEP-GJAHR MEMORY ID GJR.
SELECT-OPTIONS SP$00004 FOR ZTCO_PLANDEP-VERSN MEMORY ID KVS.
SELECT-OPTIONS SP$00005 FOR ZTCO_PLANDEP-KOSTL MEMORY ID KOS.
SELECT-OPTIONS SP$00006 FOR ZTCO_PLANDEP-ANLN1 MEMORY ID AN1.
SELECT-OPTIONS SP$00007 FOR ZTCO_PLANDEP-ANLN2 MEMORY ID AN2.
SELECT-OPTIONS SP$00008 FOR ZTCO_PLANDEP-KOART.
SELECTION-SCREEN SKIP 1.
SELECTION-SCREEN: BEGIN OF BLOCK DIRECT
                  WITH FRAME TITLE TEXT-F59.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %ALV RADIOBUTTON GROUP FUNC USER-COMMAND OUTBUT
                         DEFAULT 'X' .
SELECTION-SCREEN: COMMENT 4(26) TEXT-F72 FOR FIELD %ALV.
PARAMETERS:       %ALVL TYPE SLIS_VARI.
SELECTION-SCREEN: PUSHBUTTON 72(4) PB%EXCO USER-COMMAND EXPCOL.
SELECTION-SCREEN: END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %NOFUNC RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F66 FOR FIELD %NOFUNC
                                         MODIF ID OLD.
PARAMETERS:       %TVIEW RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 34(26) TEXT-F68 FOR FIELD %TVIEW
                                          MODIF ID OLD,
                  END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %GRAPH RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F61 FOR FIELD %GRAPH
                                         MODIF ID OLD.
PARAMETERS:       %TEXT RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 34(26) TEXT-F69 FOR FIELD %TEXT
                                          MODIF ID OLD,
                  END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %ABC RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F70 FOR FIELD %ABC
                                         MODIF ID OLD.
PARAMETERS:       %EXCEL RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 34(26) TEXT-F60 FOR FIELD %EXCEL
                                         MODIF ID OLD,
                  END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %EIS RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F63 FOR FIELD %EIS
                                         MODIF ID OLD.
SELECTION-SCREEN: END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %XINT RADIOBUTTON GROUP FUNC MODIF ID XIN.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F73 FOR FIELD %XINT
                                         MODIF ID XIN.
PARAMETERS:       %XINTK(30) LOWER CASE MODIF ID XIN.
SELECTION-SCREEN: END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %DOWN RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F64 FOR FIELD %DOWN
                                         MODIF ID OLD.
PARAMETERS:       %PATH(132) LOWER CASE MODIF ID OLD.
SELECTION-SCREEN: END OF LINE.
SELECTION-SCREEN: BEGIN OF LINE.
PARAMETERS:       %SAVE RADIOBUTTON GROUP FUNC MODIF ID OLD.
SELECTION-SCREEN: COMMENT 4(26) TEXT-F62 FOR FIELD %SAVE
                                         MODIF ID OLD.
PARAMETERS:       %LISTID(40) LOWER CASE MODIF ID OLD.
SELECTION-SCREEN: END OF LINE.
SELECTION-SCREEN: END OF BLOCK DIRECT.
SELECTION-SCREEN: END OF BLOCK PROG.

DATA: BEGIN OF %G00 OCCURS 100,
            ZTCO_PLANDEP-KOKRS LIKE ZTCO_PLANDEP-KOKRS,
            ZTCO_PLANDEP-BUKRS LIKE ZTCO_PLANDEP-BUKRS,
            ZTCO_PLANDEP-GJAHR LIKE ZTCO_PLANDEP-GJAHR,
            ZTCO_PLANDEP-VERSN LIKE ZTCO_PLANDEP-VERSN,
            ZTCO_PLANDEP-KOSTL LIKE ZTCO_PLANDEP-KOSTL,
            ZTCO_PLANDEP-ANLN1 LIKE ZTCO_PLANDEP-ANLN1,
            ZTCO_PLANDEP-ANLN2 LIKE ZTCO_PLANDEP-ANLN2,
            ZTCO_PLANDEP-KOART LIKE ZTCO_PLANDEP-KOART,
            ZTCO_PLANDEP-VAL01 LIKE ZTCO_PLANDEP-VAL01,
            ZTCO_PLANDEP-VAL02 LIKE ZTCO_PLANDEP-VAL02,
            ZTCO_PLANDEP-VAL03 LIKE ZTCO_PLANDEP-VAL03,
            ZTCO_PLANDEP-VAL04 LIKE ZTCO_PLANDEP-VAL04,
            ZTCO_PLANDEP-VAL05 LIKE ZTCO_PLANDEP-VAL05,
            ZTCO_PLANDEP-VAL06 LIKE ZTCO_PLANDEP-VAL06,
            ZTCO_PLANDEP-VAL07 LIKE ZTCO_PLANDEP-VAL07,
            ZTCO_PLANDEP-VAL08 LIKE ZTCO_PLANDEP-VAL08,
            ZTCO_PLANDEP-VAL09 LIKE ZTCO_PLANDEP-VAL09,
            ZTCO_PLANDEP-VAL10 LIKE ZTCO_PLANDEP-VAL10,
            ZTCO_PLANDEP-VAL11 LIKE ZTCO_PLANDEP-VAL11,
            ZTCO_PLANDEP-VAL12 LIKE ZTCO_PLANDEP-VAL12,
            ZTCO_PLANDEP-VAL13 LIKE ZTCO_PLANDEP-VAL13,
            ZTCO_PLANDEP-VAL14 LIKE ZTCO_PLANDEP-VAL14,
            ZTCO_PLANDEP-VAL15 LIKE ZTCO_PLANDEP-VAL15,
            ZTCO_PLANDEP-VAL16 LIKE ZTCO_PLANDEP-VAL16,
            ZTCO_PLANDEP-VAL17 LIKE ZTCO_PLANDEP-VAL17,
            ZTCO_PLANDEP-VAL18 LIKE ZTCO_PLANDEP-VAL18,
            ZTCO_PLANDEP-VAL19 LIKE ZTCO_PLANDEP-VAL19,
            ZTCO_PLANDEP-VAL20 LIKE ZTCO_PLANDEP-VAL20,
            ZTCO_PLANDEP-VAL21 LIKE ZTCO_PLANDEP-VAL21,
            ZTCO_PLANDEP-VAL22 LIKE ZTCO_PLANDEP-VAL22,
            ZTCO_PLANDEP-VAL23 LIKE ZTCO_PLANDEP-VAL23,
            ZTCO_PLANDEP-VAL24 LIKE ZTCO_PLANDEP-VAL24,
            ZTCO_PLANDEP-VAL25 LIKE ZTCO_PLANDEP-VAL25,
            ZTCO_PLANDEP-VAL26 LIKE ZTCO_PLANDEP-VAL26,
            ZTCO_PLANDEP-WAERS LIKE ZTCO_PLANDEP-WAERS,
      END OF %G00.
DATA: BEGIN OF %%G00,
            ZTCO_PLANDEP-KOKRS(004),
            ZTCO_PLANDEP-BUKRS(004),
            ZTCO_PLANDEP-GJAHR(004),
            ZTCO_PLANDEP-VERSN(003),
            ZTCO_PLANDEP-KOSTL(010),
            ZTCO_PLANDEP-ANLN1(012),
            ZTCO_PLANDEP-ANLN2(004),
            ZTCO_PLANDEP-KOART(010),
            ZTCO_PLANDEP-VAL01(016),
            ZTCO_PLANDEP-VAL02(016),
            ZTCO_PLANDEP-VAL03(016),
            ZTCO_PLANDEP-VAL04(016),
            ZTCO_PLANDEP-VAL05(016),
            ZTCO_PLANDEP-VAL06(016),
            ZTCO_PLANDEP-VAL07(016),
            ZTCO_PLANDEP-VAL08(016),
            ZTCO_PLANDEP-VAL09(016),
            ZTCO_PLANDEP-VAL10(016),
            ZTCO_PLANDEP-VAL11(016),
            ZTCO_PLANDEP-VAL12(016),
            ZTCO_PLANDEP-VAL13(016),
            ZTCO_PLANDEP-VAL14(016),
            ZTCO_PLANDEP-VAL15(016),
            ZTCO_PLANDEP-VAL16(016),
            ZTCO_PLANDEP-VAL17(016),
            ZTCO_PLANDEP-VAL18(016),
            ZTCO_PLANDEP-VAL19(016),
            ZTCO_PLANDEP-VAL20(016),
            ZTCO_PLANDEP-VAL21(016),
            ZTCO_PLANDEP-VAL22(016),
            ZTCO_PLANDEP-VAL23(016),
            ZTCO_PLANDEP-VAL24(016),
            ZTCO_PLANDEP-VAL25(016),
            ZTCO_PLANDEP-VAL26(016),
            ZTCO_PLANDEP-WAERS(005),
      END OF %%G00.
DATA %ZNR TYPE I.
DATA %LZNR TYPE I VALUE 99999.
FIELD-GROUPS HEADER.
DATA %GROUP06.
DATA %%ZTCO_PLANDEP-KOSTL LIKE ZTCO_PLANDEP-KOSTL.
DATA %%%ZTCO_PLANDEP-KOSTL(1).
DATA %GROUP0106.
DATA %GROUP0206.
DATA %GROUP0306.
DATA %GROUP05.
DATA %%ZTCO_PLANDEP-KOART LIKE ZTCO_PLANDEP-KOART.
DATA %%%ZTCO_PLANDEP-KOART(1).
DATA %GROUP0105.
DATA %GROUP0205.
DATA %GROUP0305.
DATA %GROUP04.
DATA %%ZTCO_PLANDEP-VERSN LIKE ZTCO_PLANDEP-VERSN.
DATA %%%ZTCO_PLANDEP-VERSN(1).
DATA %GROUP0104.
DATA %GROUP0204.
DATA %GROUP0304.
DATA %GROUP03.
DATA %%ZTCO_PLANDEP-GJAHR LIKE ZTCO_PLANDEP-GJAHR.
DATA %%%ZTCO_PLANDEP-GJAHR(1).
DATA %GROUP0103.
DATA %GROUP0203.
DATA %GROUP0303.
DATA %GROUP02.
DATA %%ZTCO_PLANDEP-BUKRS LIKE ZTCO_PLANDEP-BUKRS.
DATA %%%ZTCO_PLANDEP-BUKRS(1).
DATA %GROUP0102.
DATA %GROUP0202.
DATA %GROUP0302.
DATA %GROUP01.
DATA %%ZTCO_PLANDEP-KOKRS LIKE ZTCO_PLANDEP-KOKRS.
DATA %%%ZTCO_PLANDEP-KOKRS(1).
DATA %GROUP0101.
DATA %GROUP0201.
DATA %GROUP0301.
FIELD-GROUPS %FG01.
DATA %ANY-01.
DATA %EXT-ZTCO_PLANDEP01.
FIELD-GROUPS %FG02.
DATA %ANY-02.
DATA %EXT-ZTCO_PLANDEP02.
FIELD-GROUPS %FG03.
DATA %ANY-03.
DATA %EXT-ZTCO_PLANDEP03.
FIELD-GROUPS %FGWRZTCO_PLANDEP01.
FIELD-GROUPS %FGWRZTCO_PLANDEP02.
FIELD-GROUPS %FGWRZTCO_PLANDEP03.

CONTROLS TVIEW100 TYPE TABLEVIEW USING SCREEN 100.

AT SELECTION-SCREEN .
PERFORM ALVL_CHECK(RSAQEXCE) USING %ALVL 'G00'.
PERFORM TESTMODE(RSAQEXCE).
PERFORM CHECK_EXPCOL(RSAQEXCE) USING %ALV.


AT SELECTION-SCREEN ON VALUE-REQUEST FOR %ALVL .
PERFORM ALVL_VALUE_REQUEST(RSAQEXCE) USING %ALVL 'G00'.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR %XINTK .
PERFORM XINT_VALUE_REQUEST(RSAQEXCE).

AT SELECTION-SCREEN OUTPUT .

PERFORM RINIT(RSAQBRST).
PERFORM SET_EXPCOL(RSAQEXCE) USING %ALV PB%EXCO.
PERFORM ALVL_SET_INVISIBLE(RSAQEXCE).
PERFORM SET_XINT_PARAMS(RSAQEXCE).

INITIALIZATION.
PERFORM INIT_XINT(RSAQEXCE).
PERFORM SET_WWW_FLAGS(RSAQEXCE).
PERFORM INIT_PRINT_PARAMS(RSAQEXCE).

START-OF-SELECTION.
INSERT ZTCO_PLANDEP-WAERS INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL01 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL02 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL03 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL04 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL05 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL06 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL07 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-VAL08 INTO %FGWRZTCO_PLANDEP01.
INSERT ZTCO_PLANDEP-WAERS INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL09 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL10 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL11 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL12 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL13 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL14 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL15 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL16 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL17 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-VAL18 INTO %FGWRZTCO_PLANDEP02.
INSERT ZTCO_PLANDEP-WAERS INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL19 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL20 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL21 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL22 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL23 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL24 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL25 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-VAL26 INTO %FGWRZTCO_PLANDEP03.
INSERT ZTCO_PLANDEP-KOKRS INTO HEADER.
INSERT ZTCO_PLANDEP-BUKRS INTO HEADER.
INSERT ZTCO_PLANDEP-GJAHR INTO HEADER.
INSERT ZTCO_PLANDEP-VERSN INTO HEADER.
INSERT ZTCO_PLANDEP-KOART INTO HEADER.
INSERT ZTCO_PLANDEP-KOSTL INTO HEADER.
INSERT %COUNT-ZTCO_PLANDEP INTO HEADER.
INSERT %LINR-ZTCO_PLANDEP INTO HEADER.
INSERT ZTCO_PLANDEP-ANLN1 INTO %FG01.
INSERT ZTCO_PLANDEP-ANLN2 INTO %FG01.
INSERT ZTCO_PLANDEP-VAL01 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL02 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL03 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL04 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL05 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL06 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL07 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL08 INTO %FG01.
INSERT ZTCO_PLANDEP-WAERS INTO %FG01.
INSERT ZTCO_PLANDEP-VAL09 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL10 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL11 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL12 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL13 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL14 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL15 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL16 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL17 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL18 INTO %FG02.
INSERT ZTCO_PLANDEP-WAERS INTO %FG02.
INSERT ZTCO_PLANDEP-VAL19 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL20 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL21 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL22 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL23 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL24 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL25 INTO %FG03.
INSERT ZTCO_PLANDEP-VAL26 INTO %FG03.
INSERT ZTCO_PLANDEP-WAERS INTO %FG03.
PERFORM INIT_TEXTHANDLING(RSAQEXCE) USING 'CL_TEXT_IDENTIFIER' ' '
        'SYSTQV000000000000000004'.

*// == 2011.08.23 change for ECC6.  by YN.Kim ================ //*
PERFORM AUTHORITY_BEGIN(RSAQEXCE) using gv_auth_classname .
PERFORM AUTHORITY(RSAQEXCE) USING 'ZTCO_PLANDEP'
                                   gv_auth_classname .

PERFORM AUTHORITY_END(RSAQEXCE) using gv_auth_classname.
*// ===================
PERFORM %COMP_LDESC.
SELECT *
       INTO CORRESPONDING FIELDS OF ZTCO_PLANDEP
       FROM ZTCO_PLANDEP
       WHERE ANLN1 IN SP$00006
         AND ANLN2 IN SP$00007
         AND BUKRS IN SP$00002
         AND GJAHR IN SP$00003
         AND KOART IN SP$00008
         AND KOKRS IN SP$00001
         AND KOSTL IN SP$00005
         AND VERSN IN SP$00004.
  %DBACC = %DBACC - 1.
  IF %DBACC = 0.
    STOP.
  ENDIF.
  ADD 1 TO %COUNT-ZTCO_PLANDEP.
  %LINR-ZTCO_PLANDEP = '01'.
  EXTRACT %FG01.
  %EXT-ZTCO_PLANDEP01 = 'X'.
    EXTRACT %FGWRZTCO_PLANDEP01.
  %LINR-ZTCO_PLANDEP = '02'.
  EXTRACT %FG02.
  %EXT-ZTCO_PLANDEP02 = 'X'.
    EXTRACT %FGWRZTCO_PLANDEP02.
  %LINR-ZTCO_PLANDEP = '03'.
  EXTRACT %FG03.
  %EXT-ZTCO_PLANDEP03 = 'X'.
    EXTRACT %FGWRZTCO_PLANDEP03.
ENDSELECT.

END-OF-SELECTION.
SORT AS TEXT BY
        ZTCO_PLANDEP-KOKRS
        ZTCO_PLANDEP-BUKRS
        ZTCO_PLANDEP-GJAHR
        ZTCO_PLANDEP-VERSN
        ZTCO_PLANDEP-KOART
        ZTCO_PLANDEP-KOSTL
        %COUNT-ZTCO_PLANDEP
        %LINR-ZTCO_PLANDEP.
%DIACT = SPACE.
%BATCH = SY-BATCH.
IF %BATCH <> SPACE.
  IF %EIS <> SPACE.
    %DIACT = 'E'.
    IF %EISPROTOCOL = SPACE.
      NEW-PAGE PRINT ON DESTINATION 'NULL' NO DIALOG
               LINE-SIZE 0253 LINE-COUNT 0065.
    ELSE.
      NEW-PAGE PRINT ON NO DIALOG
               PARAMETERS %INIT_PRI_PARAMS.
    ENDIF.
  ENDIF.
  IF %ALV <> SPACE.
    %DIACT = 'V'.
    %ALV_LAYOUT = %ALVL.
    NEW-PAGE PRINT ON DESTINATION 'NULL' NO DIALOG
             LINE-SIZE 0253 LINE-COUNT 0065.
  ENDIF.
  IF %SAVE <> SPACE.
    %DIACT = 'S'.
    NEW-PAGE PRINT ON DESTINATION 'NULL' NO DIALOG
             LINE-SIZE 0253 LINE-COUNT 0065.
  ENDIF.
ELSEIF %CALLED_BY_WWW <> SPACE.
  %DIACT = SPACE.
ELSEIF %CALLED_BY_WWW_ALV <> SPACE.
  %DIACT = 'V'.
ELSE.
  PERFORM INIT_PRINT_PARAMS(RSAQEXCE).
  IF %SAVE  <> SPACE. %DIACT = 'S'. ENDIF.
  IF %XINT  <> SPACE. %DIACT = 'I'. ENDIF.
  IF %TVIEW <> SPACE. %DIACT = 'T'. ENDIF.
  IF %ALV   <> SPACE. %DIACT = 'V'. ENDIF.
  IF %DOWN  <> SPACE. %DIACT = 'D'. ENDIF.
  IF %EIS   <> SPACE. %DIACT = 'E'. ENDIF.
  IF %GRAPH <> SPACE. %DIACT = 'G'. ENDIF.
  IF %EXCEL <> SPACE. %DIACT = 'X'. ENDIF.
  IF %TEXT  <> SPACE. %DIACT = 'W'. ENDIF.
  IF %ABC   <> SPACE. %DIACT = 'A'. ENDIF.
  IF %DIACT <> SPACE AND %DIACT <> 'S' AND %DIACT <> 'W'.
    NEW-PAGE PRINT ON DESTINATION 'NULL' NO DIALOG
             LINE-SIZE 0253 LINE-COUNT 0065.
  ENDIF.
  %PATHNAME = %PATH.
  IF %DIACT = 'I'.
    %FUNCTIONKEY = %XINTK.
  ENDIF.
  IF %DIACT = 'V'.
    %ALV_LAYOUT = %ALVL.
  ENDIF.
ENDIF.
FREE MEMORY ID 'AQLISTDATA'.
IF %MEMMODE <> SPACE.
  IF %BATCH <> SPACE.
    NEW-PAGE PRINT ON DESTINATION 'NULL' NO DIALOG
             LINE-SIZE 0253 LINE-COUNT 0065.
  ENDIF.
  %DIACT = '1'.
ENDIF.
%TITEL = ' '.
IF SY-SUBTY O %PRFLAG AND %TITEL = SPACE.
  NEW-PAGE WITH-TITLE.
ENDIF.
%TVSIZE = 0200.
%PLINE = 1.
%PZGR  = 1.
%FIRST = 'X'.
PERFORM %OUTPUT.
%FIRST = SPACE.
IF %DIACT <> SPACE AND %DIACT <> 'S'.
  IF %BATCH = SPACE.
    NEW-PAGE PRINT OFF.
    IF NOT ( %DIACT = 'V' AND %UCOMM = 'PRIN' ).
      NEW-PAGE NO-HEADING NO-TITLE.
      WRITE SPACE.
    ENDIF.
  ENDIF.
ELSE.
  PERFORM PF-STATUS(RSAQEXCE) USING 'XXX X '.
ENDIF.
CLEAR: %TAB, %LINE, %CONT.
IF %DATA_SELECTED = SPACE.
  IF %DIACT = '1'.
    EXPORT EMPTY FROM %EMPTY TO MEMORY ID 'AQLISTDATA'.
    LEAVE.
  ELSE.
    IF %BATCH = SPACE AND
       %CALLED_BY_WWW = SPACE AND
       %CALLED_BY_WWW_ALV = SPACE.
      MESSAGE S260(AQ).
      LEAVE LIST-PROCESSING.
    ELSE.
      IF %CALLED_BY_WWW_ALV = SPACE.
        %DIACT = SPACE.
      ENDIF.
    ENDIF.
  ENDIF.
ENDIF.
IF %DIACT = 'S'.
  PERFORM %SAVE_LIST.
  LEAVE LIST-PROCESSING.
ENDIF.
IF %DIACT = 'V' AND %BATCH <> SPACE.
  NEW-PAGE PRINT OFF.
  PERFORM SET_PRINT_PARAMS(RSAQEXCE).
  PERFORM %DOWNLOAD USING 'ALV'.
  LEAVE.
ENDIF.
IF %DIACT = 'V' AND %CALLED_BY_WWW_ALV <> SPACE.
  PERFORM %DOWNLOAD USING 'ALV'.
  LEAVE.
ENDIF.
IF %DIACT = 'V' AND %UCOMM = 'PRIN'.
  NEW-PAGE PRINT OFF.
  PERFORM SET_PRINT_PARAMS(RSAQEXCE).
  PERFORM %DOWNLOAD USING 'ALV'.
  LEAVE LIST-PROCESSING.
ENDIF.
IF %DIACT = 'P' AND %BATCH <> SPACE.
  PERFORM %DOWNLOAD USING '+DAT'.
  LEAVE LIST-PROCESSING.
ENDIF.
IF %DIACT = 'E' AND %BATCH <> SPACE.
  PERFORM %DOWNLOAD USING 'EIS'.
  LEAVE LIST-PROCESSING.
ENDIF.
IF %DIACT = '1'.
  PERFORM %DOWNLOAD USING '+MEM'.
  LEAVE.
ENDIF.
IF %DIACT = 'X'.
  SET USER-COMMAND 'XXL'.
ELSEIF %DIACT = 'W'.
  SET USER-COMMAND 'TEXT'.
ELSEIF %DIACT = 'V'.
  SET USER-COMMAND 'ALV'.
ELSEIF %DIACT = 'T'.
  SET USER-COMMAND 'VIEW'.
ELSEIF %DIACT = 'G'.
  SET USER-COMMAND 'GRAF'.
ELSEIF %DIACT = 'A'.
  SET USER-COMMAND 'ABCA'.
ELSEIF %DIACT = 'E'.
  SET USER-COMMAND 'EIS'.
ELSEIF %DIACT = 'D'.
  SET USER-COMMAND 'DOWN'.
ELSEIF %DIACT = 'I'.
  SET USER-COMMAND 'XINT'.
ELSEIF %DIACT = 'P'.
  SET USER-COMMAND '+DAT'.
ENDIF.

TOP-OF-PAGE.
PERFORM %TOP-OF-PAGE.

END-OF-PAGE.
PERFORM PAGE_FOOT(RSAQEXCE).
PERFORM %SAVE_PAGE.

TOP-OF-PAGE DURING LINE-SELECTION.
PERFORM %TOP-OF-PAGE.

AT USER-COMMAND.
CASE SY-UCOMM.
WHEN 'EXIT'.
  LEAVE PROGRAM.
WHEN 'RETN'.
  PERFORM RETURN(RSAQEXCE).
WHEN 'CANC'.
  PERFORM RETURN(RSAQEXCE).
WHEN 'WEIT'.
  PERFORM RETURN(RSAQEXCE).
WHEN 'INHA'.
  PERFORM CATALOGUE(RSAQEXCE).
WHEN 'AUSL'.
  PERFORM PICKUP(RSAQEXCE).
WHEN 'AUSW'.
  PERFORM PICKUP(RSAQEXCE).
WHEN 'RCAA'.
  PERFORM RCHAIN(RSAQBRST).
WHEN 'RCAL'.
  PERFORM RCALL(RSAQBRST).
WHEN 'VGLI'.
  PERFORM CHANGE(RSAQEXCE).
WHEN 'VGLE'.
  PERFORM CHANGE(RSAQEXCE).
WHEN 'TOTO'.
  PERFORM CHANGE(RSAQEXCE).
WHEN 'VSTA'.
  PERFORM CHANGE(RSAQEXCE).
WHEN 'VSTE'.
  PERFORM RETURN(RSAQEXCE).
WHEN 'SAVL'.
  PERFORM %SAVE_LIST.
WHEN 'ODRU'.
  PERFORM PRINT_LIST(RSAQEXCE).
WHEN 'COPA'.
  PERFORM PRINT_COVER_PAGE(RSAQEXCE).
WHEN 'TEXT'.
  PERFORM %DOWNLOAD USING 'TEXT'.
WHEN 'ALV'.
  PERFORM %DOWNLOAD USING 'ALV'.
WHEN 'VIEW'.
  PERFORM %VIEW.
WHEN 'XXL'.
  PERFORM %DOWNLOAD USING 'XXL'.
WHEN 'GRAF'.
  PERFORM %DOWNLOAD USING 'GRAF'.
WHEN 'ABCA'.
  PERFORM %DOWNLOAD USING 'ABCA'.
WHEN 'EIS'.
  PERFORM %DOWNLOAD USING 'EIS'.
WHEN 'DOWN'.
  PERFORM %DOWNLOAD USING 'DOWN'.
WHEN 'XINT'.
  PERFORM %DOWNLOAD USING 'XINT'.
ENDCASE.
CLEAR: %CLINE, %ZGR.
CLEAR: %TAB, %LINE, %CONT.
IF %DIACT <> SPACE.
  LEAVE LIST-PROCESSING.
ENDIF.


FORM %COMP_LDESC.

  REFRESH %LDESC.
  REFRESH %GDESC.
  PERFORM LDESC(RSAQEXCE) USING 'G00010000X004       01  98'
    TEXT-A00 TEXT-B00 TEXT-H00 'ZTCO_PLANDEP-KOKRS' ZTCO_PLANDEP-KOKRS
    'ZTCO_PLANDEP-KOKRS'.
  PERFORM LDESC(RSAQEXCE) USING 'G00020000X004       02  98'
    TEXT-A01 TEXT-B01 TEXT-H00 'ZTCO_PLANDEP-BUKRS' ZTCO_PLANDEP-BUKRS
    'ZTCO_PLANDEP-BUKRS'.
  PERFORM LDESC(RSAQEXCE) USING 'G00030000X004       03  98'
    TEXT-A02 TEXT-B02 TEXT-H00 'ZTCO_PLANDEP-GJAHR' ZTCO_PLANDEP-GJAHR
    'ZTCO_PLANDEP-GJAHR'.
  PERFORM LDESC(RSAQEXCE) USING 'G00040000X003       04  98'
    TEXT-A03 TEXT-B03 TEXT-H00 'ZTCO_PLANDEP-VERSN' ZTCO_PLANDEP-VERSN
    'ZTCO_PLANDEP-VERSN'.
  PERFORM LDESC(RSAQEXCE) USING 'G00050000X010       06  98'
    TEXT-A04 TEXT-B04 TEXT-H00 'ZTCO_PLANDEP-KOSTL' ZTCO_PLANDEP-KOSTL
    'ZTCO_PLANDEP-KOSTL'.
  PERFORM LDESC(RSAQEXCE) USING 'G00060000X012       00  98'
    TEXT-A05 TEXT-B05 TEXT-H00 'ZTCO_PLANDEP-ANLN1' ZTCO_PLANDEP-ANLN1
    'ZTCO_PLANDEP-ANLN1'.
  PERFORM LDESC(RSAQEXCE) USING 'G00070000X004       00  98'
    TEXT-A06 TEXT-B06 TEXT-H00 'ZTCO_PLANDEP-ANLN2' ZTCO_PLANDEP-ANLN2
    'ZTCO_PLANDEP-ANLN2'.
  PERFORM LDESC(RSAQEXCE) USING 'G00080000X010       05  98'
    TEXT-A07 TEXT-B07 TEXT-H00 'ZTCO_PLANDEP-KOART' ZTCO_PLANDEP-KOART
    'ZTCO_PLANDEP-KOART'.
  PERFORM LDESC(RSAQEXCE) USING 'G00090061 016     X 00  98'
    TEXT-A08 TEXT-B08 TEXT-H00 'ZTCO_PLANDEP-VAL01' ZTCO_PLANDEP-VAL01
    'ZTCO_PLANDEP-VAL01'.
  PERFORM LDESC(RSAQEXCE) USING 'G00100084 016     X 00  98'
    TEXT-A09 TEXT-B09 TEXT-H00 'ZTCO_PLANDEP-VAL02' ZTCO_PLANDEP-VAL02
    'ZTCO_PLANDEP-VAL02'.
  PERFORM LDESC(RSAQEXCE) USING 'G00110107 016     X 00  98'
    TEXT-A10 TEXT-B10 TEXT-H00 'ZTCO_PLANDEP-VAL03' ZTCO_PLANDEP-VAL03
    'ZTCO_PLANDEP-VAL03'.
  PERFORM LDESC(RSAQEXCE) USING 'G00120130 016     X 00  98'
    TEXT-A11 TEXT-B11 TEXT-H00 'ZTCO_PLANDEP-VAL04' ZTCO_PLANDEP-VAL04
    'ZTCO_PLANDEP-VAL04'.
  PERFORM LDESC(RSAQEXCE) USING 'G00130153 016     X 00  98'
    TEXT-A12 TEXT-B12 TEXT-H00 'ZTCO_PLANDEP-VAL05' ZTCO_PLANDEP-VAL05
    'ZTCO_PLANDEP-VAL05'.
  PERFORM LDESC(RSAQEXCE) USING 'G00140176 016     X 00  98'
    TEXT-A13 TEXT-B13 TEXT-H00 'ZTCO_PLANDEP-VAL06' ZTCO_PLANDEP-VAL06
    'ZTCO_PLANDEP-VAL06'.
  PERFORM LDESC(RSAQEXCE) USING 'G00150199 016     X 00  98'
    TEXT-A14 TEXT-B14 TEXT-H00 'ZTCO_PLANDEP-VAL07' ZTCO_PLANDEP-VAL07
    'ZTCO_PLANDEP-VAL07'.
  PERFORM LDESC(RSAQEXCE) USING 'G00160222 016     X 00  98'
    TEXT-A15 TEXT-B15 TEXT-H00 'ZTCO_PLANDEP-VAL08' ZTCO_PLANDEP-VAL08
    'ZTCO_PLANDEP-VAL08'.
  PERFORM LDESC(RSAQEXCE) USING 'G00171002 016     X 00  98'
    TEXT-A16 TEXT-B16 TEXT-H00 'ZTCO_PLANDEP-VAL09' ZTCO_PLANDEP-VAL09
    'ZTCO_PLANDEP-VAL09'.
  PERFORM LDESC(RSAQEXCE) USING 'G00181025 016     X 00  98'
    TEXT-A17 TEXT-B17 TEXT-H00 'ZTCO_PLANDEP-VAL10' ZTCO_PLANDEP-VAL10
    'ZTCO_PLANDEP-VAL10'.
  PERFORM LDESC(RSAQEXCE) USING 'G00191048 016     X 00  98'
    TEXT-A18 TEXT-B18 TEXT-H00 'ZTCO_PLANDEP-VAL11' ZTCO_PLANDEP-VAL11
    'ZTCO_PLANDEP-VAL11'.
  PERFORM LDESC(RSAQEXCE) USING 'G00201071 016     X 00  98'
    TEXT-A19 TEXT-B19 TEXT-H00 'ZTCO_PLANDEP-VAL12' ZTCO_PLANDEP-VAL12
    'ZTCO_PLANDEP-VAL12'.
  PERFORM LDESC(RSAQEXCE) USING 'G00211094 016     X 00  98'
    TEXT-A20 TEXT-B20 TEXT-H00 'ZTCO_PLANDEP-VAL13' ZTCO_PLANDEP-VAL13
    'ZTCO_PLANDEP-VAL13'.
  PERFORM LDESC(RSAQEXCE) USING 'G00221117 016     X 00  98'
    TEXT-A21 TEXT-B21 TEXT-H00 'ZTCO_PLANDEP-VAL14' ZTCO_PLANDEP-VAL14
    'ZTCO_PLANDEP-VAL14'.
  PERFORM LDESC(RSAQEXCE) USING 'G00231140 016     X 00  98'
    TEXT-A22 TEXT-B22 TEXT-H00 'ZTCO_PLANDEP-VAL15' ZTCO_PLANDEP-VAL15
    'ZTCO_PLANDEP-VAL15'.
  PERFORM LDESC(RSAQEXCE) USING 'G00241163 016     X 00  98'
    TEXT-A23 TEXT-B23 TEXT-H00 'ZTCO_PLANDEP-VAL16' ZTCO_PLANDEP-VAL16
    'ZTCO_PLANDEP-VAL16'.
  PERFORM LDESC(RSAQEXCE) USING 'G00251186 016     X 00  98'
    TEXT-A24 TEXT-B24 TEXT-H00 'ZTCO_PLANDEP-VAL17' ZTCO_PLANDEP-VAL17
    'ZTCO_PLANDEP-VAL17'.
  PERFORM LDESC(RSAQEXCE) USING 'G00261209 016     X 00  98'
    TEXT-A25 TEXT-B25 TEXT-H00 'ZTCO_PLANDEP-VAL18' ZTCO_PLANDEP-VAL18
    'ZTCO_PLANDEP-VAL18'.
  PERFORM LDESC(RSAQEXCE) USING 'G00272002 016     X 00  98'
    TEXT-A26 TEXT-B26 TEXT-H00 'ZTCO_PLANDEP-VAL19' ZTCO_PLANDEP-VAL19
    'ZTCO_PLANDEP-VAL19'.
  PERFORM LDESC(RSAQEXCE) USING 'G00282025 016     X 00  98'
    TEXT-A27 TEXT-B27 TEXT-H00 'ZTCO_PLANDEP-VAL20' ZTCO_PLANDEP-VAL20
    'ZTCO_PLANDEP-VAL20'.
  PERFORM LDESC(RSAQEXCE) USING 'G00292048 016     X 00  98'
    TEXT-A28 TEXT-B28 TEXT-H00 'ZTCO_PLANDEP-VAL21' ZTCO_PLANDEP-VAL21
    'ZTCO_PLANDEP-VAL21'.
  PERFORM LDESC(RSAQEXCE) USING 'G00302071 016     X 00  98'
    TEXT-A29 TEXT-B29 TEXT-H00 'ZTCO_PLANDEP-VAL22' ZTCO_PLANDEP-VAL22
    'ZTCO_PLANDEP-VAL22'.
  PERFORM LDESC(RSAQEXCE) USING 'G00312094 016     X 00  98'
    TEXT-A30 TEXT-B30 TEXT-H00 'ZTCO_PLANDEP-VAL23' ZTCO_PLANDEP-VAL23
    'ZTCO_PLANDEP-VAL23'.
  PERFORM LDESC(RSAQEXCE) USING 'G00322117 016     X 00  98'
    TEXT-A31 TEXT-B31 TEXT-H00 'ZTCO_PLANDEP-VAL24' ZTCO_PLANDEP-VAL24
    'ZTCO_PLANDEP-VAL24'.
  PERFORM LDESC(RSAQEXCE) USING 'G00332140 016     X 00  98'
    TEXT-A32 TEXT-B32 TEXT-H00 'ZTCO_PLANDEP-VAL25' ZTCO_PLANDEP-VAL25
    'ZTCO_PLANDEP-VAL25'.
  PERFORM LDESC(RSAQEXCE) USING 'G00342163 016F    X 00  98'
    TEXT-A33 TEXT-B33 TEXT-H00 'ZTCO_PLANDEP-VAL26' ZTCO_PLANDEP-VAL26
    'ZTCO_PLANDEP-VAL26'.
  PERFORM LDESC(RSAQEXCE) USING 'G00352000X005W      00  98'
    TEXT-A34 TEXT-B34 TEXT-H00 'ZTCO_PLANDEP-WAERS' ZTCO_PLANDEP-WAERS
    'ZTCO_PLANDEP-WAERS'.
  PERFORM GDESC(RSAQEXCE) USING 'G00' 5 20 ' ' ' ' 'X'.

ENDFORM.

FORM %OUTPUT.

DESCRIBE TABLE %PRLIST LINES %MAX_PRLIST.
%HEAD = 'AAA'.
%KEYEMPTY = SPACE.
NEW-PAGE.
PERFORM %OUTPUT_GL.
PERFORM COMPLETE_PAGE(RSAQEXCE).
%HEAD = 'ZZZ'.
PERFORM LAST_PTAB_ENTRY(RSAQEXCE).
NEW-PAGE.
IF %KEYEMPTY <> SPACE.
  MESSAGE S894(AQ).
ENDIF.

ENDFORM.


FORM %TOP-OF-PAGE.

IF SY-UCOMM = 'INHA'. EXIT. ENDIF.
IF SY-UCOMM = 'COPA'. EXIT. ENDIF.
IF %HEAD    = SPACE.  EXIT. ENDIF.
IF %HEAD = 'DDD'.
  PERFORM TVIEWPAGE(RSAQEXCE).
  EXIT.
ENDIF.
IF %HEAD = 'GGG'.
  PERFORM PAGE(RSAQEXCE) USING 'G00' TEXT-GRL 252 %GLFRAME 003.
  SET LEFT SCROLL-BOUNDARY COLUMN 002.
  PERFORM SET_SCROLL_BOUNDARY(RSAQEXCE) USING 002.
  IF %TOTO <> SPACE. EXIT. ENDIF.
ELSE.
  CASE %HEAD.
  ENDCASE.
ENDIF.

ENDFORM.


FORM %NEWLINE.

  %UFLAG = SPACE.
  NEW-LINE.
  WRITE: '|', 252 '|'.
  POSITION 2.

ENDFORM.

FORM %SKIP USING COUNT.

  IF SY-LINNO > 1.
    %UFLAG = SPACE.
    DO COUNT TIMES.
      NEW-LINE.
      FORMAT RESET.
      WRITE: '|', 252 '|'.
    ENDDO.
  ENDIF.

ENDFORM.

FORM %ULINE.

  IF %UFLAG = SPACE.
    IF SY-LINNO > 1.
      ULINE /1(252).
    ENDIF.
    %UFLAG = 'X'.
  ENDIF.

ENDFORM.

FORM %HIDE.

  IF %BATCH <> SPACE AND %DIACT = 'S'.
    PERFORM HIDE(RSAQEXCE).
  ELSE.
    HIDE: %TAB, %LINE, %CONT.
  ENDIF.

ENDFORM.

FORM %HIDE_COLOR.

  IF %BATCH <> SPACE AND %DIACT = 'S'.
    PERFORM HIDE_COLOR(RSAQEXCE).
  ELSE.
    HIDE: %FINT, %FCOL.
  ENDIF.

ENDFORM.

FORM %RCALL USING NAME VALUE.

FIELD-SYMBOLS <FIELD>.

  ASSIGN (NAME) TO <FIELD>.
  READ CURRENT LINE FIELD VALUE <FIELD> INTO VALUE.
  IF SY-SUBRC <> 0.
    VALUE = SPACE.
    EXIT.
  ENDIF.
  IF VALUE = SPACE AND %TAB = 'G00' AND %LDESC-FCUR NA 'FM'.
    READ TABLE %G00 INDEX %LINE.
    IF SY-SUBRC = 0.
      ASSIGN COMPONENT %LDESC-FNAMEINT OF STRUCTURE %G00
                                       TO <FIELD>.
      IF SY-SUBRC = 0.
        WRITE <FIELD> TO VALUE(%LDESC-FOLEN).
      ENDIF.
    ENDIF.
  ENDIF.

ENDFORM.

FORM %SAVE_PAGE.

  IF %BATCH <> SPACE AND %DIACT = 'S'.
    PERFORM SAVE_PAGE(RSAQEXCE) TABLES %ST_LISTE.
  ENDIF.

ENDFORM.

FORM %REPLACE_VAR USING TEXT.

FIELD-SYMBOLS <VAR>.

  ASSIGN TEXT+1(*) TO <VAR>.

ENDFORM.

FORM %SAVE_LIST.

DATA: %SFLAG,
      QREPORT LIKE SY-REPID.

  IF %DIACT = 'S'. %SFLAG = 'X'. ENDIF.
  QREPORT = SY-REPID.
  PERFORM SAVE_LIST(RSAQEXCE) TABLES %ST_LISTE
                              USING QREPORT %SFLAG %LISTID.
  IF %QL_ID <> SPACE.
    %DLFLAG = 'X'.
    %LISTSIZE = 0253.
    PERFORM COMP_SELECTION_SCREEN(RSAQEXCE).
    EXPORT %ST_LISTE %PTAB %LDESC %GDESC %DLFLAG %LISTSIZE
           %SELECTIONS
           %G00
           TO DATABASE AQLDB(AQ) ID %QL_ID.
  ENDIF.

ENDFORM.

FORM %REFRESH.

  CASE %TAB.
  WHEN 'G00'.
    IMPORT %G00 FROM DATABASE AQLDB(AQ) ID %QL_ID.
  ENDCASE.

ENDFORM.

FORM %DOWNLOAD USING CODE.

DATA: QREPORT LIKE SY-REPID.

  PERFORM INIT_DOWNLOAD(RSAQEXCE).
  QREPORT = SY-REPID.
  CASE %TAB.
  WHEN 'G00'.
    PERFORM DOWNLOAD(RSAQEXCE)
            TABLES %G00 USING CODE QREPORT TEXT-GRL.
  WHEN OTHERS.
    MESSAGE S860(AQ).
  ENDCASE.

ENDFORM.

FORM %SET_DATA CHANGING L_LINES TYPE I.

  IMPORT LDATA TO %G00 FROM MEMORY ID 'AQLISTDATA'.
  DESCRIBE TABLE %G00 LINES L_LINES.
  FREE MEMORY ID 'AQLISTDATA'.

ENDFORM.

FORM %GET_DATA TABLES DATATAB STRUCTURE %G00
               USING  FIRST TYPE I
                      LAST  TYPE I.

  APPEND LINES OF %G00 FROM FIRST TO LAST TO DATATAB.

ENDFORM.

FORM %GET_REF_TO_TABLE USING LID         LIKE RSAQLDESC-LID
                             REF_TO_ITAB TYPE REF TO DATA
                             SUBRC       LIKE SY-SUBRC.

  SUBRC = 0.
  CASE LID.
  WHEN 'G00'.
    CREATE DATA REF_TO_ITAB LIKE %G00[].
  WHEN OTHERS.
    SUBRC = 4.
    MESSAGE S860(AQ).
  ENDCASE.

ENDFORM.

FORM %VIEW.

DATA: ANZ TYPE I,
      PROG LIKE SY-REPID.

  PROG = SY-REPID.
  PERFORM INIT_DOWNLOAD(RSAQEXCE).
  CASE %TAB.
  WHEN 'G00'.
    PERFORM GENERATE_VIEW_DYNPRO(RSAQEXCE)
            USING PROG TEXT-GRL.
    DESCRIBE TABLE %G00 LINES ANZ.
    TVIEW100-LINES = ANZ.
    PERFORM INIT_VIEW(RSAQEXCE) TABLES %G00 USING TVIEW100.
    CALL SCREEN 100.
    PERFORM RESET_VIEW_DYNPRO(RSAQEXCE).
  WHEN OTHERS.
    MESSAGE S860(AQ).
  ENDCASE.

ENDFORM.


FORM %CLEAR02.

  CLEAR %G00-ZTCO_PLANDEP-VAL09.
  CLEAR %G00-ZTCO_PLANDEP-VAL10.
  CLEAR %G00-ZTCO_PLANDEP-VAL11.
  CLEAR %G00-ZTCO_PLANDEP-VAL12.
  CLEAR %G00-ZTCO_PLANDEP-VAL13.
  CLEAR %G00-ZTCO_PLANDEP-VAL14.
  CLEAR %G00-ZTCO_PLANDEP-VAL15.
  CLEAR %G00-ZTCO_PLANDEP-VAL16.
  CLEAR %G00-ZTCO_PLANDEP-VAL17.
  CLEAR %G00-ZTCO_PLANDEP-VAL18.
  PERFORM %CLEAR03.

ENDFORM.


FORM %CLEAR03.

  CLEAR %G00-ZTCO_PLANDEP-VAL19.
  CLEAR %G00-ZTCO_PLANDEP-VAL20.
  CLEAR %G00-ZTCO_PLANDEP-VAL21.
  CLEAR %G00-ZTCO_PLANDEP-VAL22.
  CLEAR %G00-ZTCO_PLANDEP-VAL23.
  CLEAR %G00-ZTCO_PLANDEP-VAL24.
  CLEAR %G00-ZTCO_PLANDEP-VAL25.
  CLEAR %G00-ZTCO_PLANDEP-VAL26.
  CLEAR %G00-ZTCO_PLANDEP-WAERS.

ENDFORM.


FORM %OUTPUT_GL.

IF %MAX_PRLIST <> 0.
  READ TABLE %PRLIST WITH KEY TAB = 'GGG'.
  IF SY-SUBRC <> 0.
    EXIT.
  ENDIF.
ENDIF.
SET MARGIN 00.
PERFORM COMPLETE_PAGE(RSAQEXCE).
%NOCHANGE = SPACE.
NEW-PAGE.
REFRESH %WA010.
REFRESH %WA020.
REFRESH %WA030.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0100.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0102.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0103.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0105.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0101.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0106.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
REFRESH %W0104.
%GLLINE   = 0.
%TAB      = 'G00'.
%LINE     = 0.
%CONT     = '0'.
%FINT     = SPACE.
%FCOL     = '0'.
%HEAD     = 'GGG'.
%CLINE    = 0.
%OUTFLAG  = SPACE.
%OUTCOMP  = SPACE.
%OUTTOTAL = SPACE.
%RFLAG    = 'AA'.
IF %DIACT <> SPACE AND %DIACT NA 'SWE'. WRITE SPACE. ENDIF.
FORMAT RESET.
LOOP.
  %DATA_SELECTED = 'X'.
  AT %FG01.
    %ZNR = '01'.
    %ZGR = '01'.
    %CLINE = %CLINE + 1.
    PERFORM %CLEAR02.
    %G00-ZTCO_PLANDEP-KOKRS = ZTCO_PLANDEP-KOKRS.
    %G00-ZTCO_PLANDEP-BUKRS = ZTCO_PLANDEP-BUKRS.
    %G00-ZTCO_PLANDEP-GJAHR = ZTCO_PLANDEP-GJAHR.
    %G00-ZTCO_PLANDEP-VERSN = ZTCO_PLANDEP-VERSN.
    %G00-ZTCO_PLANDEP-KOSTL = ZTCO_PLANDEP-KOSTL.
    %G00-ZTCO_PLANDEP-ANLN1 = ZTCO_PLANDEP-ANLN1.
    %G00-ZTCO_PLANDEP-ANLN2 = ZTCO_PLANDEP-ANLN2.
    %G00-ZTCO_PLANDEP-KOART = ZTCO_PLANDEP-KOART.
    %G00-ZTCO_PLANDEP-VAL01 = ZTCO_PLANDEP-VAL01.
    %G00-ZTCO_PLANDEP-VAL02 = ZTCO_PLANDEP-VAL02.
    %G00-ZTCO_PLANDEP-VAL03 = ZTCO_PLANDEP-VAL03.
    %G00-ZTCO_PLANDEP-VAL04 = ZTCO_PLANDEP-VAL04.
    %G00-ZTCO_PLANDEP-VAL05 = ZTCO_PLANDEP-VAL05.
    %G00-ZTCO_PLANDEP-VAL06 = ZTCO_PLANDEP-VAL06.
    %G00-ZTCO_PLANDEP-VAL07 = ZTCO_PLANDEP-VAL07.
    %G00-ZTCO_PLANDEP-VAL08 = ZTCO_PLANDEP-VAL08.
    IF %FIRST <> SPACE. APPEND %G00. ENDIF.
    %GLLINE = %GLLINE + 1.
    %LZNR = %ZNR.
    IF %DIACT <> SPACE AND %DIACT NA 'SWE'. CONTINUE. ENDIF.
    PERFORM CHECK(RSAQEXCE) USING ' '.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    IF %RFLAG = 'AA'.
      PERFORM RESERVE(RSAQEXCE) USING 003.
    ENDIF.
IF ZTCO_PLANDEP-KOKRS <> %%ZTCO_PLANDEP-KOKRS OR %%%ZTCO_PLANDEP-KOKRS =
SPACE.
      %%ZTCO_PLANDEP-KOKRS = ZTCO_PLANDEP-KOKRS.
      %%%ZTCO_PLANDEP-KOKRS ='X'.
      CLEAR %%ZTCO_PLANDEP-BUKRS.
      CLEAR %%%ZTCO_PLANDEP-BUKRS.
      CLEAR %%ZTCO_PLANDEP-GJAHR.
      CLEAR %%%ZTCO_PLANDEP-GJAHR.
      CLEAR %%ZTCO_PLANDEP-VERSN.
      CLEAR %%%ZTCO_PLANDEP-VERSN.
      CLEAR %%ZTCO_PLANDEP-KOART.
      CLEAR %%%ZTCO_PLANDEP-KOART.
      CLEAR %%ZTCO_PLANDEP-KOSTL.
      CLEAR %%%ZTCO_PLANDEP-KOSTL.
    ENDIF.
IF ZTCO_PLANDEP-BUKRS <> %%ZTCO_PLANDEP-BUKRS OR %%%ZTCO_PLANDEP-BUKRS =
SPACE.
      %%ZTCO_PLANDEP-BUKRS = ZTCO_PLANDEP-BUKRS.
      %%%ZTCO_PLANDEP-BUKRS ='X'.
      CLEAR %%ZTCO_PLANDEP-GJAHR.
      CLEAR %%%ZTCO_PLANDEP-GJAHR.
      CLEAR %%ZTCO_PLANDEP-VERSN.
      CLEAR %%%ZTCO_PLANDEP-VERSN.
      CLEAR %%ZTCO_PLANDEP-KOART.
      CLEAR %%%ZTCO_PLANDEP-KOART.
      CLEAR %%ZTCO_PLANDEP-KOSTL.
      CLEAR %%%ZTCO_PLANDEP-KOSTL.
    ENDIF.
IF ZTCO_PLANDEP-GJAHR <> %%ZTCO_PLANDEP-GJAHR OR %%%ZTCO_PLANDEP-GJAHR =
SPACE.
      %%ZTCO_PLANDEP-GJAHR = ZTCO_PLANDEP-GJAHR.
      %%%ZTCO_PLANDEP-GJAHR ='X'.
      CLEAR %%ZTCO_PLANDEP-VERSN.
      CLEAR %%%ZTCO_PLANDEP-VERSN.
      CLEAR %%ZTCO_PLANDEP-KOART.
      CLEAR %%%ZTCO_PLANDEP-KOART.
      CLEAR %%ZTCO_PLANDEP-KOSTL.
      CLEAR %%%ZTCO_PLANDEP-KOSTL.
    ENDIF.
IF ZTCO_PLANDEP-VERSN <> %%ZTCO_PLANDEP-VERSN OR %%%ZTCO_PLANDEP-VERSN =
SPACE.
      %%ZTCO_PLANDEP-VERSN = ZTCO_PLANDEP-VERSN.
      %%%ZTCO_PLANDEP-VERSN ='X'.
      CLEAR %%ZTCO_PLANDEP-KOART.
      CLEAR %%%ZTCO_PLANDEP-KOART.
      CLEAR %%ZTCO_PLANDEP-KOSTL.
      CLEAR %%%ZTCO_PLANDEP-KOSTL.
    ENDIF.
IF ZTCO_PLANDEP-KOART <> %%ZTCO_PLANDEP-KOART OR %%%ZTCO_PLANDEP-KOART =
SPACE.
      %%ZTCO_PLANDEP-KOART = ZTCO_PLANDEP-KOART.
      %%%ZTCO_PLANDEP-KOART ='X'.
      CLEAR %%ZTCO_PLANDEP-KOSTL.
      CLEAR %%%ZTCO_PLANDEP-KOSTL.
    ENDIF.
IF ZTCO_PLANDEP-KOSTL <> %%ZTCO_PLANDEP-KOSTL OR %%%ZTCO_PLANDEP-KOSTL =
SPACE.
      %%ZTCO_PLANDEP-KOSTL = ZTCO_PLANDEP-KOSTL.
      %%%ZTCO_PLANDEP-KOSTL ='X'.
    ENDIF.
    IF %RFLAG(1) = 'A'.
    FORMAT RESET.
    %FINT = 'F'. %FCOL = '0'.
    FORMAT COLOR 2. %FCOL = '2'.
    PERFORM %NEWLINE.
    WRITE 002(004) ZTCO_PLANDEP-KOKRS.
    %LINE = %GLLINE.
    PERFORM %HIDE.
    %LINE = 0.
    IF %RFLAG = 'AA'. HIDE %CLINE. ENDIF. HIDE %ZGR.
    PERFORM %HIDE_COLOR.
    WRITE 007(004) ZTCO_PLANDEP-BUKRS.
    WRITE 012(004) ZTCO_PLANDEP-GJAHR.
    WRITE 017(003) ZTCO_PLANDEP-VERSN.
    WRITE 021(010) ZTCO_PLANDEP-KOSTL
      INTENSIFIED OFF
      COLOR 5 ON.
    WRITE 032(012) ZTCO_PLANDEP-ANLN1.
    WRITE 045(004) ZTCO_PLANDEP-ANLN2.
    WRITE 050(010) ZTCO_PLANDEP-KOART
      INTENSIFIED OFF
      COLOR 7 ON.
    WRITE 061(016) ZTCO_PLANDEP-VAL01
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 084(016) ZTCO_PLANDEP-VAL02
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 107(016) ZTCO_PLANDEP-VAL03
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 130(016) ZTCO_PLANDEP-VAL04
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 153(016) ZTCO_PLANDEP-VAL05
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 176(016) ZTCO_PLANDEP-VAL06
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 199(016) ZTCO_PLANDEP-VAL07
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 222(016) ZTCO_PLANDEP-VAL08
      CURRENCY ZTCO_PLANDEP-WAERS.
    ENDIF.
  ENDAT.
  AT %FG02.
    %ZNR = '02'.
    %ZGR = '01'.
    IF %ZNR > %LZNR.
      READ TABLE %G00 INDEX %GLLINE.
    ENDIF.
    PERFORM %CLEAR03.
    %G00-ZTCO_PLANDEP-VAL09 = ZTCO_PLANDEP-VAL09.
    %G00-ZTCO_PLANDEP-VAL10 = ZTCO_PLANDEP-VAL10.
    %G00-ZTCO_PLANDEP-VAL11 = ZTCO_PLANDEP-VAL11.
    %G00-ZTCO_PLANDEP-VAL12 = ZTCO_PLANDEP-VAL12.
    %G00-ZTCO_PLANDEP-VAL13 = ZTCO_PLANDEP-VAL13.
    %G00-ZTCO_PLANDEP-VAL14 = ZTCO_PLANDEP-VAL14.
    %G00-ZTCO_PLANDEP-VAL15 = ZTCO_PLANDEP-VAL15.
    %G00-ZTCO_PLANDEP-VAL16 = ZTCO_PLANDEP-VAL16.
    %G00-ZTCO_PLANDEP-VAL17 = ZTCO_PLANDEP-VAL17.
    %G00-ZTCO_PLANDEP-VAL18 = ZTCO_PLANDEP-VAL18.
    IF %ZNR > %LZNR.
      IF %FIRST <> SPACE. MODIFY %G00 INDEX %GLLINE. ENDIF.
    ELSE.
      IF %FIRST <> SPACE. APPEND %G00. ENDIF.
      %GLLINE = %GLLINE + 1.
    ENDIF.
    %LZNR = %ZNR.
    IF %DIACT <> SPACE AND %DIACT NA 'SWE'. CONTINUE. ENDIF.
    PERFORM CHECK(RSAQEXCE) USING ' '.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    IF %RFLAG(1) = 'A'.
    FORMAT RESET.
    %FINT = 'F'. %FCOL = '0'.
    FORMAT COLOR 2. %FCOL = '2'.
    PERFORM %NEWLINE.
    WRITE 002(016) ZTCO_PLANDEP-VAL09
      CURRENCY ZTCO_PLANDEP-WAERS.
    %LINE = %GLLINE.  %CONT = '1'.
    PERFORM %HIDE.
    %LINE = 0.  %CONT = '0'.
    IF %RFLAG = 'AA'. HIDE %CLINE. ENDIF. HIDE %ZGR.
    PERFORM %HIDE_COLOR.
    WRITE 025(016) ZTCO_PLANDEP-VAL10
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 048(016) ZTCO_PLANDEP-VAL11
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 071(016) ZTCO_PLANDEP-VAL12
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 094(016) ZTCO_PLANDEP-VAL13
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 117(016) ZTCO_PLANDEP-VAL14
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 140(016) ZTCO_PLANDEP-VAL15
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 163(016) ZTCO_PLANDEP-VAL16
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 186(016) ZTCO_PLANDEP-VAL17
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 209(016) ZTCO_PLANDEP-VAL18
      CURRENCY ZTCO_PLANDEP-WAERS.
    ENDIF.
  ENDAT.
  AT %FG03.
    %ZNR = '03'.
    %ZGR = '01'.
    IF %ZNR > %LZNR.
      READ TABLE %G00 INDEX %GLLINE.
    ENDIF.
    %G00-ZTCO_PLANDEP-VAL19 = ZTCO_PLANDEP-VAL19.
    %G00-ZTCO_PLANDEP-VAL20 = ZTCO_PLANDEP-VAL20.
    %G00-ZTCO_PLANDEP-VAL21 = ZTCO_PLANDEP-VAL21.
    %G00-ZTCO_PLANDEP-VAL22 = ZTCO_PLANDEP-VAL22.
    %G00-ZTCO_PLANDEP-VAL23 = ZTCO_PLANDEP-VAL23.
    %G00-ZTCO_PLANDEP-VAL24 = ZTCO_PLANDEP-VAL24.
    %G00-ZTCO_PLANDEP-VAL25 = ZTCO_PLANDEP-VAL25.
    %G00-ZTCO_PLANDEP-VAL26 = ZTCO_PLANDEP-VAL26.
    %G00-ZTCO_PLANDEP-WAERS = ZTCO_PLANDEP-WAERS.
    IF %ZNR > %LZNR.
      IF %FIRST <> SPACE. MODIFY %G00 INDEX %GLLINE. ENDIF.
    ELSE.
      IF %FIRST <> SPACE. APPEND %G00. ENDIF.
      %GLLINE = %GLLINE + 1.
    ENDIF.
    %LZNR = %ZNR.
    IF %DIACT <> SPACE AND %DIACT NA 'SWE'. CONTINUE. ENDIF.
    PERFORM CHECK(RSAQEXCE) USING ' '.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    IF %RFLAG(1) = 'A'.
    FORMAT RESET.
    %FINT = 'F'. %FCOL = '0'.
    FORMAT COLOR 2. %FCOL = '2'.
    PERFORM %NEWLINE.
    WRITE 002(016) ZTCO_PLANDEP-VAL19
      CURRENCY ZTCO_PLANDEP-WAERS.
    %LINE = %GLLINE.  %CONT = '2'.
    PERFORM %HIDE.
    %LINE = 0.  %CONT = '0'.
    IF %RFLAG = 'AA'. HIDE %CLINE. ENDIF. HIDE %ZGR.
    PERFORM %HIDE_COLOR.
    WRITE 025(016) ZTCO_PLANDEP-VAL20
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 048(016) ZTCO_PLANDEP-VAL21
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 071(016) ZTCO_PLANDEP-VAL22
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 094(016) ZTCO_PLANDEP-VAL23
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 117(016) ZTCO_PLANDEP-VAL24
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 140(016) ZTCO_PLANDEP-VAL25
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 163(016) ZTCO_PLANDEP-VAL26
      CURRENCY ZTCO_PLANDEP-WAERS.
    WRITE 180(005) ZTCO_PLANDEP-WAERS.
    ENDIF.
  ENDAT.
  AT %FGWRZTCO_PLANDEP03.
    CLEAR %W0106.
    %W0106-ZTCO_PLANDEP-WAERS = ZTCO_PLANDEP-WAERS.
    %W0106-ZTCO_PLANDEP-VAL19 = ZTCO_PLANDEP-VAL19.
    %W0106-ZTCO_PLANDEP-VAL20 = ZTCO_PLANDEP-VAL20.
    %W0106-ZTCO_PLANDEP-VAL21 = ZTCO_PLANDEP-VAL21.
    %W0106-ZTCO_PLANDEP-VAL22 = ZTCO_PLANDEP-VAL22.
    %W0106-ZTCO_PLANDEP-VAL23 = ZTCO_PLANDEP-VAL23.
    %W0106-ZTCO_PLANDEP-VAL24 = ZTCO_PLANDEP-VAL24.
    %W0106-ZTCO_PLANDEP-VAL25 = ZTCO_PLANDEP-VAL25.
    %W0106-ZTCO_PLANDEP-VAL26 = ZTCO_PLANDEP-VAL26.
    COLLECT %W0106.
  ENDAT.
  AT %FGWRZTCO_PLANDEP02.
    CLEAR %W0106.
    %W0106-ZTCO_PLANDEP-WAERS = ZTCO_PLANDEP-WAERS.
    %W0106-ZTCO_PLANDEP-VAL09 = ZTCO_PLANDEP-VAL09.
    %W0106-ZTCO_PLANDEP-VAL10 = ZTCO_PLANDEP-VAL10.
    %W0106-ZTCO_PLANDEP-VAL11 = ZTCO_PLANDEP-VAL11.
    %W0106-ZTCO_PLANDEP-VAL12 = ZTCO_PLANDEP-VAL12.
    %W0106-ZTCO_PLANDEP-VAL13 = ZTCO_PLANDEP-VAL13.
    %W0106-ZTCO_PLANDEP-VAL14 = ZTCO_PLANDEP-VAL14.
    %W0106-ZTCO_PLANDEP-VAL15 = ZTCO_PLANDEP-VAL15.
    %W0106-ZTCO_PLANDEP-VAL16 = ZTCO_PLANDEP-VAL16.
    %W0106-ZTCO_PLANDEP-VAL17 = ZTCO_PLANDEP-VAL17.
    %W0106-ZTCO_PLANDEP-VAL18 = ZTCO_PLANDEP-VAL18.
    COLLECT %W0106.
  ENDAT.
  AT %FGWRZTCO_PLANDEP01.
    CLEAR %W0106.
    %W0106-ZTCO_PLANDEP-WAERS = ZTCO_PLANDEP-WAERS.
    %W0106-ZTCO_PLANDEP-VAL01 = ZTCO_PLANDEP-VAL01.
    %W0106-ZTCO_PLANDEP-VAL02 = ZTCO_PLANDEP-VAL02.
    %W0106-ZTCO_PLANDEP-VAL03 = ZTCO_PLANDEP-VAL03.
    %W0106-ZTCO_PLANDEP-VAL04 = ZTCO_PLANDEP-VAL04.
    %W0106-ZTCO_PLANDEP-VAL05 = ZTCO_PLANDEP-VAL05.
    %W0106-ZTCO_PLANDEP-VAL06 = ZTCO_PLANDEP-VAL06.
    %W0106-ZTCO_PLANDEP-VAL07 = ZTCO_PLANDEP-VAL07.
    %W0106-ZTCO_PLANDEP-VAL08 = ZTCO_PLANDEP-VAL08.
    COLLECT %W0106.
  ENDAT.
  AT END OF ZTCO_PLANDEP-KOSTL.
    %ZGR = '01'.
    PERFORM CHECK(RSAQEXCE) USING 'X'.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    LOOP AT %W0106.
      %W0105 = %W0106.
      COLLECT %W0105.
    ENDLOOP.
    REFRESH %W0106.
  ENDAT.
  AT END OF ZTCO_PLANDEP-KOART.
    %ZGR = '01'.
    PERFORM CHECK(RSAQEXCE) USING 'X'.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    LOOP AT %W0105.
      %W0104 = %W0105.
      COLLECT %W0104.
    ENDLOOP.
    REFRESH %W0105.
  ENDAT.
  AT END OF ZTCO_PLANDEP-VERSN.
    %ZGR = '01'.
    PERFORM CHECK(RSAQEXCE) USING 'X'.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    LOOP AT %W0104.
      %W0103 = %W0104.
      COLLECT %W0103.
    ENDLOOP.
    REFRESH %W0104.
  ENDAT.
  AT END OF ZTCO_PLANDEP-GJAHR.
    %ZGR = '01'.
    PERFORM CHECK(RSAQEXCE) USING 'X'.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    LOOP AT %W0103.
      %W0102 = %W0103.
      COLLECT %W0102.
    ENDLOOP.
    REFRESH %W0103.
  ENDAT.
  AT END OF ZTCO_PLANDEP-BUKRS.
    %ZGR = '01'.
    PERFORM CHECK(RSAQEXCE) USING 'X'.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    LOOP AT %W0102.
      %W0101 = %W0102.
      COLLECT %W0101.
    ENDLOOP.
    REFRESH %W0102.
  ENDAT.
  AT END OF ZTCO_PLANDEP-KOKRS.
    %ZGR = '01'.
    PERFORM CHECK(RSAQEXCE) USING 'X'.
    IF %RFLAG = 'E'. EXIT. ENDIF.
    LOOP AT %W0101.
      %W0100 = %W0101.
      COLLECT %W0100.
    ENDLOOP.
    REFRESH %W0101.
  ENDAT.
  AT LAST.
    %ZNR = 0.
    %RFLAG = 'AA'.
    %OUTTOTAL = 'X'.
    PERFORM RESERVE(RSAQEXCE) USING 2.
    PERFORM %ULINE.
    FORMAT RESET.
    FORMAT INTENSIFIED ON COLOR 3.
    %FINT = 'N'. %FCOL = '3'.
    %NOCHANGE = 'X'.
    PERFORM %NEWLINE.
    %NOCHANGE = SPACE.
    WRITE (13) TEXT-F02.
    PERFORM %HIDE.
    PERFORM %HIDE_COLOR.
    SORT %W0100 BY ZTCO_PLANDEP-WAERS.
      PERFORM %NEWLINE.
      WRITE 239 '*'.
      REFRESH %WA010.
      DO.
        %SUBRC = 4.
        CLEAR %WA010.
        READ TABLE %W0100 INDEX SY-INDEX.
        IF SY-SUBRC = 0.
          %SUBRC = 0.
          %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS =
          %W0100-ZTCO_PLANDEP-WAERS.
          %WA010-ZTCO_PLANDEP-VAL08 = %W0100-ZTCO_PLANDEP-VAL08.
          %WA010-ZTCO_PLANDEP-VAL07 = %W0100-ZTCO_PLANDEP-VAL07.
          %WA010-ZTCO_PLANDEP-VAL06 = %W0100-ZTCO_PLANDEP-VAL06.
          %WA010-ZTCO_PLANDEP-VAL05 = %W0100-ZTCO_PLANDEP-VAL05.
          %WA010-ZTCO_PLANDEP-VAL01 = %W0100-ZTCO_PLANDEP-VAL01.
          %WA010-ZTCO_PLANDEP-VAL02 = %W0100-ZTCO_PLANDEP-VAL02.
          %WA010-ZTCO_PLANDEP-VAL03 = %W0100-ZTCO_PLANDEP-VAL03.
          %WA010-ZTCO_PLANDEP-VAL04 = %W0100-ZTCO_PLANDEP-VAL04.
        ENDIF.
        IF %SUBRC = 4.
          EXIT.
        ENDIF.
        APPEND %WA010.
      ENDDO.
      LOOP AT %WA010.
        IF SY-TABIX <> 1.
          PERFORM %NEWLINE.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 061(016) %WA010-ZTCO_PLANDEP-VAL01
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL01 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 061(016) %WA010-ZTCO_PLANDEP-VAL01
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 084(016) %WA010-ZTCO_PLANDEP-VAL02
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL02 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 084(016) %WA010-ZTCO_PLANDEP-VAL02
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 107(016) %WA010-ZTCO_PLANDEP-VAL03
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL03 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 107(016) %WA010-ZTCO_PLANDEP-VAL03
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 130(016) %WA010-ZTCO_PLANDEP-VAL04
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL04 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 130(016) %WA010-ZTCO_PLANDEP-VAL04
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 153(016) %WA010-ZTCO_PLANDEP-VAL05
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL05 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 153(016) %WA010-ZTCO_PLANDEP-VAL05
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 176(016) %WA010-ZTCO_PLANDEP-VAL06
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL06 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 176(016) %WA010-ZTCO_PLANDEP-VAL06
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 199(016) %WA010-ZTCO_PLANDEP-VAL07
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL07 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 199(016) %WA010-ZTCO_PLANDEP-VAL07
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 222(016) %WA010-ZTCO_PLANDEP-VAL08
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA010-ZTCO_PLANDEP-VAL08 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 222(016) %WA010-ZTCO_PLANDEP-VAL08
                CURRENCY %WA010-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        PERFORM %HIDE.
        PERFORM %HIDE_COLOR.
      ENDLOOP.
      PERFORM %NEWLINE.
      WRITE 239 '*'.
      REFRESH %WA020.
      DO.
        %SUBRC = 4.
        CLEAR %WA020.
        READ TABLE %W0100 INDEX SY-INDEX.
        IF SY-SUBRC = 0.
          %SUBRC = 0.
          %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS =
          %W0100-ZTCO_PLANDEP-WAERS.
          %WA020-ZTCO_PLANDEP-VAL14 = %W0100-ZTCO_PLANDEP-VAL14.
          %WA020-ZTCO_PLANDEP-VAL15 = %W0100-ZTCO_PLANDEP-VAL15.
          %WA020-ZTCO_PLANDEP-VAL16 = %W0100-ZTCO_PLANDEP-VAL16.
          %WA020-ZTCO_PLANDEP-VAL17 = %W0100-ZTCO_PLANDEP-VAL17.
          %WA020-ZTCO_PLANDEP-VAL18 = %W0100-ZTCO_PLANDEP-VAL18.
          %WA020-ZTCO_PLANDEP-VAL09 = %W0100-ZTCO_PLANDEP-VAL09.
          %WA020-ZTCO_PLANDEP-VAL10 = %W0100-ZTCO_PLANDEP-VAL10.
          %WA020-ZTCO_PLANDEP-VAL11 = %W0100-ZTCO_PLANDEP-VAL11.
          %WA020-ZTCO_PLANDEP-VAL12 = %W0100-ZTCO_PLANDEP-VAL12.
          %WA020-ZTCO_PLANDEP-VAL13 = %W0100-ZTCO_PLANDEP-VAL13.
        ENDIF.
        IF %SUBRC = 4.
          EXIT.
        ENDIF.
        APPEND %WA020.
      ENDDO.
      LOOP AT %WA020.
        IF SY-TABIX <> 1.
          PERFORM %NEWLINE.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 002(016) %WA020-ZTCO_PLANDEP-VAL09
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL09 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 002(016) %WA020-ZTCO_PLANDEP-VAL09
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 025(016) %WA020-ZTCO_PLANDEP-VAL10
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL10 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 025(016) %WA020-ZTCO_PLANDEP-VAL10
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 048(016) %WA020-ZTCO_PLANDEP-VAL11
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL11 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 048(016) %WA020-ZTCO_PLANDEP-VAL11
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 071(016) %WA020-ZTCO_PLANDEP-VAL12
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL12 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 071(016) %WA020-ZTCO_PLANDEP-VAL12
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 094(016) %WA020-ZTCO_PLANDEP-VAL13
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL13 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 094(016) %WA020-ZTCO_PLANDEP-VAL13
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 117(016) %WA020-ZTCO_PLANDEP-VAL14
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL14 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 117(016) %WA020-ZTCO_PLANDEP-VAL14
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 140(016) %WA020-ZTCO_PLANDEP-VAL15
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL15 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 140(016) %WA020-ZTCO_PLANDEP-VAL15
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 163(016) %WA020-ZTCO_PLANDEP-VAL16
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL16 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 163(016) %WA020-ZTCO_PLANDEP-VAL16
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 186(016) %WA020-ZTCO_PLANDEP-VAL17
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL17 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 186(016) %WA020-ZTCO_PLANDEP-VAL17
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 209(016) %WA020-ZTCO_PLANDEP-VAL18
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA020-ZTCO_PLANDEP-VAL18 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 209(016) %WA020-ZTCO_PLANDEP-VAL18
                CURRENCY %WA020-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        PERFORM %HIDE.
        PERFORM %HIDE_COLOR.
      ENDLOOP.
      PERFORM %NEWLINE.
      WRITE 239 '*'.
      REFRESH %WA030.
      DO.
        %SUBRC = 4.
        CLEAR %WA030.
        READ TABLE %W0100 INDEX SY-INDEX.
        IF SY-SUBRC = 0.
          %SUBRC = 0.
          %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS =
          %W0100-ZTCO_PLANDEP-WAERS.
          %WA030-ZTCO_PLANDEP-VAL23 = %W0100-ZTCO_PLANDEP-VAL23.
          %WA030-ZTCO_PLANDEP-VAL24 = %W0100-ZTCO_PLANDEP-VAL24.
          %WA030-ZTCO_PLANDEP-VAL25 = %W0100-ZTCO_PLANDEP-VAL25.
          %WA030-ZTCO_PLANDEP-VAL26 = %W0100-ZTCO_PLANDEP-VAL26.
          %WA030-ZTCO_PLANDEP-VAL22 = %W0100-ZTCO_PLANDEP-VAL22.
          %WA030-ZTCO_PLANDEP-VAL21 = %W0100-ZTCO_PLANDEP-VAL21.
          %WA030-ZTCO_PLANDEP-VAL20 = %W0100-ZTCO_PLANDEP-VAL20.
          %WA030-ZTCO_PLANDEP-VAL19 = %W0100-ZTCO_PLANDEP-VAL19.
        ENDIF.
        IF %SUBRC = 4.
          EXIT.
        ENDIF.
        APPEND %WA030.
      ENDDO.
      LOOP AT %WA030.
        IF SY-TABIX <> 1.
          PERFORM %NEWLINE.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 002(016) %WA030-ZTCO_PLANDEP-VAL19
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL19 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 002(016) %WA030-ZTCO_PLANDEP-VAL19
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 025(016) %WA030-ZTCO_PLANDEP-VAL20
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL20 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 025(016) %WA030-ZTCO_PLANDEP-VAL20
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 048(016) %WA030-ZTCO_PLANDEP-VAL21
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL21 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 048(016) %WA030-ZTCO_PLANDEP-VAL21
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 071(016) %WA030-ZTCO_PLANDEP-VAL22
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL22 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 071(016) %WA030-ZTCO_PLANDEP-VAL22
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 094(016) %WA030-ZTCO_PLANDEP-VAL23
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL23 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 094(016) %WA030-ZTCO_PLANDEP-VAL23
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 117(016) %WA030-ZTCO_PLANDEP-VAL24
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL24 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 117(016) %WA030-ZTCO_PLANDEP-VAL24
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 140(016) %WA030-ZTCO_PLANDEP-VAL25
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL25 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 140(016) %WA030-ZTCO_PLANDEP-VAL25
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        IF %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS = SPACE.
          WRITE 163(016) %WA030-ZTCO_PLANDEP-VAL26
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS NO-ZERO.
          IF NOT %WA030-ZTCO_PLANDEP-VAL26 IS INITIAL.
            %KEYEMPTY = 'X'.
          ENDIF.
        ELSE.
          WRITE 163(016) %WA030-ZTCO_PLANDEP-VAL26
                CURRENCY %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        ENDIF.
        WRITE 180(005) %WA030-ZTCO_PLANDEP-ZTCO_PLANDEP-WAERS.
        PERFORM %HIDE.
        PERFORM %HIDE_COLOR.
      ENDLOOP.
    IF %RFLAG = 'AA'. PERFORM %ULINE. ENDIF.
  ENDAT.
ENDLOOP.
%RFLAG = 'AA'.
PERFORM %ULINE.
CLEAR: %CLINE, %ZGR.

ENDFORM.



MODULE %INIT_VIEW OUTPUT.

  CASE %TAB.
  WHEN 'G00'.
    PERFORM INIT_PBO(RSAQEXCE) TABLES %G00 USING TVIEW100 'X'.
  WHEN OTHERS.
    MESSAGE S860(AQ).
  ENDCASE.

ENDMODULE.

MODULE %PBO_VIEW OUTPUT.

  CASE %TAB.
  WHEN 'G00'.
    PERFORM LOOP_PBO(RSAQEXCE) TABLES %G00 USING %%G00 TVIEW100.
  ENDCASE.

ENDMODULE.

MODULE %PAI_VIEW INPUT.

  CASE %TAB.
  WHEN 'G00'.
    PERFORM LOOP_PAI(RSAQEXCE) TABLES %G00 USING %%G00 TVIEW100.
  ENDCASE.

ENDMODULE.

MODULE %OKCODE_VIEW INPUT.

  CASE %TAB.
  WHEN 'G00'.
    PERFORM OKCODE(RSAQEXCE) TABLES %G00 USING TVIEW100.
  ENDCASE.

ENDMODULE.
